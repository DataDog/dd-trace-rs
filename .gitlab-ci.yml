stages:
  - config-validation

include:
  - local: ".gitlab/configuration-central-validation.yml"

variables:
  REPO_LANG: rust
  REPO_NOTIFICATION_CHANNEL: "#dd-trace-rs-alerts"

default:
  tags: ["runner:main", "size:large"]

# Config inversion CI steps
validate_supported_configurations_v2_local_file:
  stage: config-validation
  image: registry.ddbuild.io/ci/libdatadog-build/packaging:82290795
  rules:
    - when: on_success
  extends: .validate_supported_configurations_v2_local_file
  variables:
    LOCAL_JSON_PATH: "supported-configurations.json"
    BACKFILLED: "true"

# Executed on release (branch with tag vx.y.z)
update_central_configurations_version_range_v2:
  stage: config-validation
  image: registry.ddbuild.io/ci/libdatadog-build/packaging:82290795
  extends: .update_central_configurations_version_range_v2
  variables:
    LOCAL_REPO_NAME: "dd-trace-rs"
    LOCAL_JSON_PATH: "supported-configurations.json"
    LANGUAGE_NAME: "rust"
    SEND_ALIASES: "true"
    TAG_PREFIX: "datadog-opentelemetry-v"
